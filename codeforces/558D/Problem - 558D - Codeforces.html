<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html><head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta name="X-Csrf-Token" content="96a313ddfd107301534c229738907f43">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta http-equiv="profileName" content="c2">
    <meta name="google-site-verification" content="OTd2dN5x4nS4OPknPI9JFg36fKxjqY0i1PSfFPv_J90">
    <meta property="fb:admins" content="100001352546622">
    <meta property="og:image" content="http://st.codeforces.com/images/codeforces-telegram-square.png">
    <link rel="image_src" href="http://st.codeforces.com/images/codeforces-telegram-square.png">
    <meta property="og:title" content="Problem - 558D - Codeforces">
    <meta property="og:description" content="">
    
    <meta property="og:site_name" content="Codeforces">
    
    <meta name="cc" content="umkhikswfe0t">
    <meta name="pc" content="32uzdpdfpkuz">
    <meta name="verify-reformal" content="f56f99fd7e087fb6ccb48ef2">
    <title>Problem - 558D - Codeforces</title>
        <meta name="description" content="Codeforces. Programming competitions and contests, programming community">
        <meta name="keywords" content="programming algorithm contest competition informatics olympiads c++ java graphs vkcup">
    <meta name="robots" content="index, follow">

    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/font-awesome.css" type="text/css" charset="utf-8">

        <link href="Problem%20-%20558D%20-%20Codeforces_files/css.css" rel="stylesheet" type="text/css">


    <link rel="shortcut icon" type="image/png" href="http://st.codeforces.com/favicon.png">

    <!--CombineResourcesFilter-->
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/prettify.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/clear.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/style.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/ttypography.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/problem-statement.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/second-level-menu.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/roundbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/datatable.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/table-form.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/topic.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/jquery_003.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/facebox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/jquery.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/jquery_002.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/codeforces.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/colorbox.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/jquery_004.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/community.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/status.css" type="text/css" charset="utf-8">
        <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/sidebar-menu.css" type="text/css" charset="utf-8">

    <script src="Problem%20-%20558D%20-%20Codeforces_files/ga.js" async="" type="text/javascript"></script><script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/prettify.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery-1.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/sockjs-0.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/vertxbus-2.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_006.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_003.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_009.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/facebox.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_005.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/wysiwyg_004.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/wysiwyg_002.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/wysiwyg.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/wysiwyg_003.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_007.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_002.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_004.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_008.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_010.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/codeforces-options.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/codeforces.js"></script>
    <!--/CombineResourcesFilter-->

    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/style_002.css" type="text/css" charset="utf-8">
    <link rel="stylesheet" href="Problem%20-%20558D%20-%20Codeforces_files/style_003.css" type="text/css" charset="utf-8">

    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/share.js" charset="utf-8"></script>
    
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/jquery_011.js"></script>
    <script type="text/javascript" src="Problem%20-%20558D%20-%20Codeforces_files/set.js"></script>

    <!--[if IE]>
    <style>
        #sidebar {
            padding-left: 1em;
            margin: 1em 1em 1em 0;
        }
    </style>
    <![endif]-->


</head>
<body><span style="display:none;" class="csrf-token" data-csrf="96a313ddfd107301534c229738907f43">&nbsp;</span>
<div class="button-up" style="opacity: 0.7; width: 30px; height: 100%; position: fixed; left: 0px; top: 0px; cursor: pointer; text-align: center; line-height: 30px; color: rgb(211, 219, 228); font-weight: bold; font-size: 20px;"><i class="icon-circle-arrow-up"></i></div>

<!-- Codeforces JavaScripts. -->
<script type="text/javascript">
    if (window.parent.frames.length > 0) {
        window.stop();
    }
</script>

    <script type="text/javascript">
        $(document).ready(function () {
    (function () {
        jQuery.expr[':'].containsCI = function(elem, index, match) {
            return !match || !match.length || match.length < 4 || !match[3] || (
                    elem.textContent || elem.innerText || jQuery(elem).text() || ''
            ).toLowerCase().indexOf(match[3].toLowerCase()) >= 0;
        }
    }(jQuery));

    $.ajaxPrefilter(function(options, originalOptions, xhr) {
        var csrf = Codeforces.getCsrfToken();

        if (csrf) {
            var data = originalOptions.data;
            if (originalOptions.data !== undefined) {
                if (Object.prototype.toString.call(originalOptions.data) === '[object String]') {
                    data = $.deparam(originalOptions.data);
                }
            } else {
                data = {};
            }
            options.data = $.param($.extend(data, { csrf_token: csrf }));
        }
    });

    window.getCodeforcesServerTime = function(callback) {
        $.post("/data/time", {}, callback, "json");
    }

    window.updateTypography = function () {
        $("div.ttypography code").addClass("tt");
        $("div.ttypography pre>code").addClass("prettyprint").removeClass("tt");
        $("div.ttypography table").addClass("bordertable");
        prettyPrint();
    }

    $.ajaxSetup({ scriptCharset: "utf-8" ,contentType: "application/x-www-form-urlencoded; charset=UTF-8", headers: {
        'X-Csrf-Token': Codeforces.getCsrfToken()
    }});

    window.updateTypography();

    Codeforces.signForms();

    $(".second-level-menu-list").lavaLamp({
        fx: "backout",
        speed: 1000
    });


    Codeforces.countdown();
    $("a[rel='photobox']").colorbox();

        var count = 0;

        function getDelay() {
            var delay = 0;
            var last = Codeforces.getCookie("lastOnlineTimeUpdaterInvocation");
            if (last && last != null) {
                var period = count < 20 ? 180 * 1000 : 360 * 1000;
                delay = period - (new Date().getTime() - last);
                if (delay < 0)
                    delay = 0;
            }
            return delay;
        }

        window.setInterval(function () {
            if (getDelay() <= 0 && count < 120) {
                ++count;
                Codeforces.ping("/data/update-online");
            }
        }, 5000);

        var handle = "Shadowmourne";
        $("a.rated-user:contains(" + handle + "), span.participant:contains(" + handle + ")").each(function () {
            if ($(this).text() == handle) {
                var td = $(this).parent();
                var tr = $(this).parent().parent();
                if (td.is("td") && tr.is("tr")) {
                    tr.addClass("highlighted-row");
                }
            }
        });

    $(".clickable-title").click(function() {
        Codeforces.alert($(this).attr("title"));
    }).css("position", "relative").css("bottom", "3px");

        });
    </script>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-743380-5']);
  _gaq.push(['_trackPageview']);

  (function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = (document.location.protocol == 'https:' ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<div id="body">
        
<div id="header" style="position: relative;">
    <div style="float:left;">
            <a href="http://codeforces.com/"><img src="Problem%20-%20558D%20-%20Codeforces_files/codeforces-logo-with-telegram.png"></a>
    </div>
    <div class="lang-chooser">
        <div style="text-align: right;">
            <a href="http://codeforces.com/problemset/problem/558/D?locale=en"><img src="Problem%20-%20558D%20-%20Codeforces_files/gb.png" title="In English" alt="In English"></a>
            <a href="http://codeforces.com/problemset/problem/558/D?locale=ru"><img src="Problem%20-%20558D%20-%20Codeforces_files/ru.png" title="По-русски" alt="По-русски"></a>
        </div>
        <div>
                <a href="http://codeforces.com/profile/Shadowmourne">Shadowmourne</a>
                 | 
                <a href="http://codeforces.com/d73c4cc1a0792818f1686631dcffa321/logout">Logout</a>
                
        </div>
    </div>
    <div style="font-size: 0.8em; margin-top: 0.25em; position: absolute; right: 0; top: 4.25em;">
    </div>
    <br style="clear: both;">
</div>

        
    <div class="roundbox menu-box" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<div class="menu-list-container">
    <ul class="menu-list main-menu-list">
                <li class=""><a href="http://codeforces.com/">Home</a></li>
                <li class=""><a href="http://codeforces.com/contests">Contests</a></li>
                <li class=""><a href="http://codeforces.com/gyms">Gym</a></li>
                <li class="current"><a href="http://codeforces.com/problemset">Problemset</a></li>
                <li class=""><a href="http://codeforces.com/groups">Groups</a></li>
                <li class=""><a href="http://codeforces.com/ratings">Rating</a></li>
                <li class=""><a href="http://codeforces.com/api/help">API</a></li>
                <li class=""><a href="http://codeforces.com/help">Help</a></li>
                <li class=""><a href="http://codeforces.com/testlib">Testlib</a></li>
                <li class=""><a href="http://codeforces.com/rcc2015">RCC <img class="icon" src="Problem%20-%20558D%20-%20Codeforces_files/cup.png"></a></li>
                <li class=""><a href="http://codeforces.com/vkcup2015">VK Cup 2015 <img class="icon" src="Problem%20-%20558D%20-%20Codeforces_files/cup.png"></a></li>
    </ul>
    <form method="post" action="/search"><input name="csrf_token" value="96a313ddfd107301534c229738907f43" type="hidden">
        <input class="search" name="query" data-isplaceholder="true" value="Search by tag">
    <input name="_tta" value="731" type="hidden"></form>
    <br style="clear: both;">
</div>
    </div>

    <script type="text/javascript">
        $(document).ready(function () {
            $("input.search").focus(function () {
                if ($(this).attr("data-isPlaceholder") === "true") {
                    $(this).val("");
                    $(this).removeAttr("data-isPlaceholder");
                }
            });
        });
    </script>
    <div style="margin:1em;text-align: center;" class="alert alert-success" data-infobarid="12">
        <i class="icon-star"></i> You can register on the coming round individually or in 2-members team. It will be rated for all individuals and teams.
        <span class="infobar-close" style="float: right; cursor: pointer; font-size: 1.4em;">×</span>
    </div>
    <script type="text/javascript">
        $(document).ready(function () {
    $(".infobar-close").click(function () {
        $(this).parent().fadeOut();
        $.post("/data/infobars", {action: "hide", infoBarId: $(this).parent().attr("data-infoBarId")}, function (response) {
            // No operations.
        }, "json");
    });
        });
    </script>
        <br style="height: 3em; clear: both;">
        <div style="position: relative;">
                    <div id="sidebar">

    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <table class="rtable ">
            <tbody>
                <tr>
                            <th class="left" style="width:100%;"><a style="color: black" href="http://codeforces.com/contest/558">Codeforces Round #312 (Div. 2)</a></th>
                </tr>
                    <tr>
                                <td class="left " colspan="1"><span class="contest-state-phase">Finished</span></td>
                    </tr>
                    <tr>
                                <td class="left  dark" colspan="1"><span class="contest-state-regular">Practice</span></td>
                    </tr>
                    <tr>
                                <td class="left bottom" colspan="1"><span class="contest-state-regular"><center>
    <span>
            <img class="toggle-favourite add-favourite" title="Add to favourites" alt="Add to favourites" data-type="CONTEST" data-entityid="558" data-size="24" src="Problem%20-%20558D%20-%20Codeforces_files/star_gray_24.png">
    </span>

    <script type="text/javascript">
        $(document).ready(function () {
            $("img.toggle-favourite").click(function () {
                var size = $(this).attr("data-size");
                var img = $(this);

                var isFavourite = !img.hasClass("remove-favourite");
                var type = img.attr("data-type");
                var entityId = img.attr("data-entityId");

                $.post("/data/favourite",
                        { entityId: entityId, type: type, isFavourite: isFavourite },
                        function(response) {
                            if (response["success"] != "true") {
                                alert(response["message"]);
                            } else {
                                if (img.hasClass("remove-favourite")) {
                                    img.attr("src", "http://st.codeforces.com/images/icons/star_gray_" + size + ".png");
                                    img.removeClass("remove-favourite");
                                    img.addClass("add-favourite");
                                } else {
                                    img.attr("src", "http://st.codeforces.com/images/icons/star_yellow_" + size + ".png");
                                    img.removeClass("add-favourite");
                                    img.addClass("remove-favourite");
                                }
                            }
                        }, "json"
                );

                return false;
            });
        });
    </script>
</center></span></td>
                    </tr>
            </tbody>
        </table>
    </div>


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Virtual participation
            <div class="top-links">
            </div>
        </div>

<div>
    <div style="margin:1em;font-size:0.8em;">
        Virtual contest is a way to take part in past contest, as close 
as possible to participation on time. It is supported only ACM-ICPC mode
 for virtual contests.

If you've seen these problems, a virtual contest is not for you - solve 
these problems in the archive.

If you just want to solve some problem from a contest, a virtual contest
 is not for you - solve this problem in the archive.

Never use someone else's code, read the tutorials or communicate this 
other person during a virtual contest.
    </div>

    <div style="text-align:center;margin:1em;">
        <form action="/contest/558/virtual" method="get">
            <input name="submit" value="Start virtual contest" style="padding:0 0.5em;" type="submit">
        </form>
    </div>
</div>
    </div>

<style type="text/css">
    .submitForm .field {
        font-size: 11px;
        width: 3em !important;
        padding-right: 1em;
    }

    .submitForm input, .submitForm select {
        font-size: 11px;
        width: 17em;
    }
</style>
    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Submit?
            <div class="top-links">
            </div>
        </div>
<div>
    <form method="post" action="?csrf_token=96a313ddfd107301534c229738907f43" enctype="multipart/form-data" class="submitForm"><input name="csrf_token" value="96a313ddfd107301534c229738907f43" type="hidden">
        <input name="ftaa" value="" type="hidden">
        <input name="bfaa" value="" type="hidden">
        <input name="action" value="submitSolutionFormSubmitted" type="hidden">
        <input name="submittedProblemIndex" value="D" type="hidden">
        <input name="source" value="" type="hidden">

        <table class="table-form" style="width:90%;">
            <tbody><tr>
                <td class="field">Language:</td>
                <td>
                    <select name="programTypeId">
                        <option value="10">GNU GCC 4.9.2</option>
                        <option value="43">GNU GCC C11 4.9.2</option>
                        <option value="1">GNU G++ 4.9.2</option>
                        <option value="42" selected="selected">GNU G++11 4.9.2</option>
                        <option value="2">Microsoft Visual C++ 2010</option>
                        <option value="9">C# Mono 2.10</option>
                        <option value="29">MS C# .NET 4</option>
                        <option value="28">D DMD32 Compiler v2</option>
                        <option value="32">Go 1.2</option>
                        <option value="12">Haskell GHC 7.6</option>
                        <option value="23">Java 7</option>
                        <option value="36">Java 8</option>
                        <option value="19">OCaml 4</option>
                        <option value="3">Delphi 7</option>
                        <option value="4">Free Pascal 2</option>
                        <option value="13">Perl 5.12</option>
                        <option value="6">PHP 5.3</option>
                        <option value="7">Python 2.7</option>
                        <option value="31">Python 3.4</option>
                        <option value="40">PyPy 2.5.0</option>
                        <option value="41">PyPy 3.2.5</option>
                        <option value="8">Ruby 2</option>
                        <option value="20">Scala 2.11</option>
                        <option value="34">JavaScript V8 3</option>
                    </select>
                </td>
            </tr>

            <tr>
                <td class="field">Choose file:</td>
                <td>
                    <input name="sourceFile" value="" type="file">
                </td>
            </tr>

            <tr>
                <td colspan="2">
                    <div style="text-align: center;">

                            <div style="font-size: 11px; width: 100%; margin: 0.5em auto;">
                                Be careful: there is 50 points penalty 
for submission which fails the pretests or resubmission (except failure 
on the first test, denial of judgement or similar verdicts). "Passed 
pretests" submission verdict doesn't guarantee that the solution is 
absolutely correct and it will pass system tests.
                            </div>


                        <input style="width:10em;" class="submit" value="Submit" type="submit">
                    </div>
                </td>
            </tr>
        </tbody></table>
    <input name="_tta" value="731" type="hidden"></form>
</div>
    </div>

        <script type="text/javascript">
            $(function() {
                window._ftaa = "c296z2fky0a4qhxbz7";
            })
        </script>

        <script type="text/javascript">
            $(function() {
                window._bfaa = "e60a12e002c1b07789d02c52f3957874";
            });
        </script>

<script>
    $(function () {
        $(".submit-form, .submitForm").submit(function () {
            var $ftaa = $(this).find("input[name='ftaa']");
            var $bfaa = $(this).find("input[name='bfaa']");

            if (window._ftaa && window._bfaa) {
                $ftaa.val(window._ftaa);
                $bfaa.val(window._bfaa);
            }
            return true;
        });
    });
</script>


    <div class="roundbox sidebox" style="">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
        <div class="caption titled">→ Problem tags
            <div class="top-links">
            </div>
        </div>
<div style="padding: 0.5em;">
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Heaps, binary search trees, segment trees, hash tables, etc">
    data structures
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Implementation problems, programming technics, simulation">
    implementation
</span>
    </div>
    <div class="roundbox " style="margin:2px; padding:0 3px 2px 3px; background-color:#f0f0f0;float:left;">
            <div class="roundbox-lt">&nbsp;</div>
            <div class="roundbox-rt">&nbsp;</div>
            <div class="roundbox-lb">&nbsp;</div>
            <div class="roundbox-rb">&nbsp;</div>
<span class="tag-box" style="font-size:12px;" title="Sortings, orderings">
    sortings
</span>
    </div>
    <div style="clear:both;text-align:right;font-size:11px;">
            <span title="Problem should be solved" class="notice">No tag edit access</span>
    </div>
</div>
    </div>

<form id="addTagForm" action="/data/problemTags" method="post" style="display:none;"><input name="csrf_token" value="96a313ddfd107301534c229738907f43" type="hidden">
    <input name="action" value="addTag" type="hidden">
    <input name="problemId" value="31489" type="hidden">
    <input name="tagName" value="" type="hidden">
<input name="_tta" value="731" type="hidden"></form>

<form id="removeTagForm" action="/data/problemTags" method="post" style="display:none;"><input name="csrf_token" value="96a313ddfd107301534c229738907f43" type="hidden">
    <input name="action" value="removeTag" type="hidden">
    <input name="problemId" value="31489" type="hidden">
    <input name="tagName" value="" type="hidden">
<input name="_tta" value="731" type="hidden"></form>

<script type="text/javascript">
    $(".tag-box img").click(function () {
        var tagName = $(this).attr("value");
        Codeforces.confirm("Are you sure you want to remove this tag?", function () {
            $("#removeTagForm input[name=tagName]").val(tagName);
            $("#removeTagForm").submit();
        }, function () {
        }, "Yes", "No");
    });

    $("#addTagLink").click(function () {
        $(this).hide();
        $("#addTagLabel").show();
        return false;
    });

    $("#addTagSelect").change(function () {
        var tagName = $(this).val();
        if (tagName === "") {
            $("#addTagLabel").hide();
            $("#addTagLink").show();
        } else {
            $("#addTagForm input[name=tagName]").val(tagName);
            $("#addTagForm").submit();
        }
    });
</script>

<style type="text/css">
#new-resource-form tr td {
padding-top: 0.5em;
}
#new-resource-form input:not([type="submit"]) {
font-size: 0.8em;
}
#new-resource-form select {
font-size: 0.8em;
}
</style>
<div class="roundbox sidebox sidebar-menu" style="">
<div class="roundbox-lt">&nbsp;</div>
<div class="roundbox-rt">&nbsp;</div>
<div class="caption titled">→ Contest materials
<div class="top-links">
</div>
</div>
<ul>
<li>
<span>
<a href="http://codeforces.com/blog/entry/19173" title="Codeforces Round #312 (Div. 2)" target="_blank">Announcement</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceid="3461" resourcename="Codeforces Round #312 (Div. 2)" resourcemanual="true" src="Problem%20-%20558D%20-%20Codeforces_files/close-10x10.png" style="position: relative;bottom: -1px;left: 1px;cursor: pointer;">
</span>
<div style="clear: both;"></div>
</li>
<li>
<span>
<a href="http://codeforces.com/blog/entry/19212" title="Codeforces Round #312 (Div. 2) Editorial" target="_blank">Tutorial</a>
</span>
<span style="float: right;">
<img class="delete-resource-link" resourceid="3460" resourcename="Codeforces Round #312 (Div. 2) Editorial" resourcemanual="true" src="Problem%20-%20558D%20-%20Codeforces_files/close-10x10.png" style="position: relative;bottom: -1px;left: 1px;cursor: pointer;">
</span>
<div style="clear: both;"></div>
</li>
</ul>
</div></div>
                    <div id="pageContent" class="content-with-sidebar">
                <div class="second-level-menu">
<ul class="second-level-menu-list"><li style="position: absolute; display: block; margin: 0px; padding: 0px; left: 0px; top: 0px; width: 72px; height: 20px;" class="backLava"><div class="leftLava"></div><div class="bottomLava"></div><div class="cornerLava"></div></li>
        <li class="current selectedLava"><a href="http://codeforces.com/problemset">Problems</a></li>
        <li><a href="http://codeforces.com/problemset/submit">Submit</a></li>
        <li><a href="http://codeforces.com/problemset/status">Status</a></li>
        <li><a href="http://codeforces.com/problemset/standings">Standings</a></li>
        <li><a href="http://codeforces.com/problemset/customtest">Custom test</a></li>
</ul>
</div>

<div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">D. Guess Your Way Out! II</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Amr
 bought a new video game "Guess Your Way Out! II". The goal of the game 
is to find an exit from the maze that looks like a perfect binary tree 
of height <span class="tex-span"><i>h</i></span>. The player is initially standing at the root of the tree and the exit from the tree is located at some leaf node.</p><p>Let's index all the nodes of the tree such that </p><ul> <li> The root is number <span class="tex-span">1</span> </li><li> Each internal node <span class="tex-span"><i>i</i></span> (<span class="tex-span"><i>i</i> ≤ 2<sup class="upper-index"><i>h</i> - 1</sup> - 1</span>) will have a left child with index = <span class="tex-span">2<i>i</i></span> and a right child with index = <span class="tex-span">2<i>i</i> + 1</span> </li></ul><p>The level of a node is defined as <span class="tex-span">1</span> for a root, or <span class="tex-span">1</span> + level of parent of the node otherwise. The vertices of the level <span class="tex-span"><i>h</i></span> are called leaves. The exit to the maze is located at some leaf node <span class="tex-span"><i>n</i></span>, the player doesn't know where the exit is so he has to guess his way out! </p><p>In the new version of the game the player is allowed to ask questions on the format "Does the <span class="tex-span"><i>ancestor</i>(<i>exit</i>, <i>i</i>)</span> node number belong to the range <span class="tex-span">[<i>L</i>, <i>R</i>]</span>?". Here <span class="tex-span"><i>ancestor</i>(<i>v</i>, <i>i</i>)</span> is the ancestor of a node <span class="tex-span"><i>v</i></span> that located in the level <span class="tex-span"><i>i</i></span>.
 The game will answer with "Yes" or "No" only. The game is designed such
 that it doesn't always answer correctly, and sometimes it cheats to 
confuse the player!.</p><p>Amr asked a lot of questions and got confused
 by all these answers, so he asked you to help him. Given the questions 
and its answers, can you identify whether the game is telling 
contradictory information or not? If the information is not 
contradictory and the exit node can be determined uniquely, output its 
number. If the information is not contradictory, but the exit node isn't
 defined uniquely, output that the number of questions is not 
sufficient. Otherwise output that the information is contradictory.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>h</i>, <i>q</i></span> (<span class="tex-span">1 ≤ <i>h</i> ≤ 50</span>, <span class="tex-span">0 ≤ <i>q</i> ≤ 10<sup class="upper-index">5</sup></span>), the height of the tree and the number of questions respectively.</p><p>The next <span class="tex-span"><i>q</i></span> lines will contain four integers each <span class="tex-span"><i>i</i>, <i>L</i>, <i>R</i>, <i>ans</i></span> (<span class="tex-span">1 ≤ <i>i</i> ≤ <i>h</i></span>, <span class="tex-span">2<sup class="upper-index"><i>i</i> - 1</sup> ≤ <i>L</i> ≤ <i>R</i> ≤ 2<sup class="upper-index"><i>i</i></sup> - 1</span>, <img class="tex-formula" src="Problem%20-%20558D%20-%20Codeforces_files/efee5db22bd8e5a4848907ab50b074b75fa6f3c7.png" align="middle">), representing a question as described in the statement with its answer (<span class="tex-span"><i>ans</i> = 1</span> if the answer is "Yes" and <span class="tex-span"><i>ans</i> = 0</span> if the answer is "No").</p></div><div class="output-specification"><div class="section-title">Output</div><p>If the information provided by the game is contradictory output "Game cheated!" without the quotes.</p><p>Else if you can uniquely identify the exit to the maze output its index. </p><p>Otherwise output "Data not sufficient!" without the quotes.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 1<br>3 4 6 0<br></pre></div><div class="output"><div class="title">Output</div><pre>7</pre></div><div class="input"><div class="title">Input</div><pre>4 3<br>4 10 14 1<br>3 6 6 0<br>2 3 3 1<br></pre></div><div class="output"><div class="title">Output</div><pre>14</pre></div><div class="input"><div class="title">Input</div><pre>4 2<br>3 4 6 1<br>4 12 15 1<br></pre></div><div class="output"><div class="title">Output</div><pre>Data not sufficient!</pre></div><div class="input"><div class="title">Input</div><pre>4 2<br>3 4 5 1<br>2 3 3 1<br></pre></div><div class="output"><div class="title">Output</div><pre>Game cheated!</pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Node <span class="tex-span"><i>u</i></span> is an ancestor of node <span class="tex-span"><i>v</i></span> if and only if </p><ul> <li> <span class="tex-span"><i>u</i></span> is the same node as <span class="tex-span"><i>v</i></span>, </li><li> <span class="tex-span"><i>u</i></span> is the parent of node <span class="tex-span"><i>v</i></span>, </li><li> or <span class="tex-span"><i>u</i></span> is an ancestor of the parent of node <span class="tex-span"><i>v</i></span>. </li></ul><p>In the first sample test there are <span class="tex-span">4</span> leaf nodes <span class="tex-span">4, 5, 6, 7</span>. The first question says that the node isn't in the range <span class="tex-span">[4, 6]</span> so the exit is node number <span class="tex-span">7</span>.</p><p>In the second sample test there are <span class="tex-span">8</span> leaf nodes. After the first question the exit is in the range <span class="tex-span">[10, 14]</span>. After the second and the third questions only node number <span class="tex-span">14</span> is correct. Check the picture below to fully understand.</p><p><img class="tex-graphics" src="Problem%20-%20558D%20-%20Codeforces_files/6de0323adb181ac17b5c0ec35bba1ca6cbfba14b.png"></p></div></div></div>
</div>


<script type="text/javascript">
    $(document).ready(function () {
        function endsWith(string, suffix) {
            return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }

        var inputFileDiv = $("div.input-file");
        var inputFile = inputFileDiv.text();
        var outputFileDiv = $("div.output-file");
        var outputFile = outputFileDiv.text();

        if (!endsWith(inputFile, "standard input")) {
            inputFileDiv.attr("style", "font-weight: bold");
        }

        if (!endsWith(outputFile, "standard output")) {
            outputFileDiv.attr("style", "font-weight: bold");
        }

        var titleDiv = $("div.header div.title");



    });
</script>
            </div>
        </div>
            <br style="clear: both;">
            <div id="footer">
                <div><a href="http://codeforces.com/">Codeforces</a> (c) Copyright 2010-2015 Mike Mirzayanov</div>
                <div>The only programming contests Web 2.0 platform</div>
                    <div>Server time: 2015-07-30 16:39:39 (c2).</div>
            </div>
    <script type="text/javascript">
        $(document).ready(function () {
            if ($(window).width() < 1600) {
                $('.button-up').css('width', '30px').css('line-height', '30px').css('font-size', '20px');
            }

            if ($(window).width() >= 1200) {
                $ (window).scroll (function () {
                    if ($ (this).scrollTop () > 100) {
                        $ ('.button-up').fadeIn();
                    } else {
                        $ ('.button-up').fadeOut();
                    }
                });

                $('.button-up').click(function () {
                    $('body,html').animate({
                        scrollTop: 0
                    }, 500);
                    return false;
                });

                $('.button-up').hover(function () {
                    $(this).animate({
                        'opacity':'1'
                    }).css({'background-color':'#e7ebf0','color':'#6a86a4'});
                }, function () {
                    $(this).animate({
                        'opacity':'0.7'
                    }).css({'background':'none','color':'#d3dbe4'});;
                });
            }
            Codeforces.focusOnError();
        });
    </script>
</div>


<div id="datepick-div" style="display: none;"></div><div style="display: none;" id="cboxOverlay"></div><div style="display: none; padding-bottom: 42px; padding-right: 42px;" class="" id="colorbox"><div id="cboxWrapper"><div><div style="float: left;" id="cboxTopLeft"></div><div style="float: left;" id="cboxTopCenter"></div><div style="float: left;" id="cboxTopRight"></div></div><div style="clear: left;"><div style="float: left;" id="cboxMiddleLeft"></div><div style="float: left;" id="cboxContent"><div style="width: 0px; height: 0px; overflow: hidden; float: left;" id="cboxLoadedContent"></div><div style="float: left;" id="cboxLoadingOverlay"></div><div style="float: left;" id="cboxLoadingGraphic"></div><div style="float: left;" id="cboxTitle"></div><div style="float: left;" id="cboxCurrent"></div><div style="float: left;" id="cboxNext"></div><div style="float: left;" id="cboxPrevious"></div><div style="float: left;" id="cboxSlideshow"></div><div style="float: left;" id="cboxClose"></div></div><div style="float: left;" id="cboxMiddleRight"></div></div><div style="clear: left;"><div style="float: left;" id="cboxBottomLeft"></div><div style="float: left;" id="cboxBottomCenter"></div><div style="float: left;" id="cboxBottomRight"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none;"></div></div><div style="position: fixed; display: none; z-index: 2147480000; background-color: rgb(255, 255, 255); padding: 4px; color: rgb(0, 0, 0); border-radius: 7px; font-size: 12px; max-width: 400px; font-family: &quot;Arial Black&quot;,Gadget,sans-serif; line-height: 100%; text-align: left; border-style: solid; border-width: 1px; border-color: rgb(0, 0, 0); opacity: 1;"></div><div style="display: none; position: fixed; max-height: 665px; width: 450px; padding: 3px; border-width: 0px 0px 2px 2px; border-style: dashed; border-color: grey; border-radius: 0px 0px 0px 5px; background-color: rgb(255, 255, 255); overflow: auto; min-height: 200px; z-index: 2147479999; text-align: center; color: rgb(0, 0, 0); right: 0px; top: 0px;"><textarea style="height: 80px; width: 444px; border: 1px solid grey; padding: 2px;"></textarea><select><option value="af">Afrikaans</option><option value="sq">Albanian</option><option value="ar">Arabic</option><option value="hy">Armenian</option><option value="az">Azerbaijani</option><option value="eu">Basque</option><option value="be">Belarusian</option><option value="bg">Bulgarian</option><option value="ca">Catalan</option><option value="zh-CN">Chinese (Simplified)</option><option value="zh-TW">Chinese (Traditional)</option><option value="hr">Croatian</option><option value="cs">Czech</option><option value="da">Danish</option><option value="auto" selected="selected">Detect language</option><option value="nl">Dutch</option><option value="en">English</option><option value="et">Estonian</option><option value="tl">Filipino</option><option value="fi">Finnish</option><option value="fr">French</option><option value="gl">Galician</option><option value="ka">Georgian</option><option value="de">German</option><option value="el">Greek</option><option value="ht">Haitian Creole</option><option value="iw">Hebrew</option><option value="hi">Hindi</option><option value="hu">Hungarian</option><option value="is">Icelandic</option><option value="id">Indonesian</option><option value="ga">Irish</option><option value="it">Italian</option><option value="ja">Japanese</option><option value="ko">Korean</option><option value="la">Latin</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="mk">Macedonian</option><option value="ms">Malay</option><option value="mt">Maltese</option><option value="no">Norwegian</option><option value="fa">Persian</option><option value="pl">Polish</option><option value="pt">Portuguese</option><option value="ro">Romanian</option><option value="ru">Russian</option><option value="sr">Serbian</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option value="es">Spanish</option><option value="sw">Swahili</option><option value="sv">Swedish</option><option value="th">Thai</option><option value="tr">Turkish</option><option value="uk">Ukrainian</option><option value="ur">Urdu</option><option value="vi">Vietnamese</option><option value="cy">Welsh</option><option value="yi">Yiddish</option></select><span style="font-weight: bold; cursor: pointer; color: lightgrey;">⇄</span><select><option selected="selected" value="af">Afrikaans</option><option value="sq">Albanian</option><option value="ar">Arabic</option><option value="hy">Armenian</option><option value="az">Azerbaijani</option><option value="eu">Basque</option><option value="be">Belarusian</option><option value="bg">Bulgarian</option><option value="ca">Catalan</option><option value="zh-CN">Chinese (Simplified)</option><option value="zh-TW">Chinese (Traditional)</option><option value="hr">Croatian</option><option value="cs">Czech</option><option value="da">Danish</option><option value="nl">Dutch</option><option value="en">English</option><option value="et">Estonian</option><option value="tl">Filipino</option><option value="fi">Finnish</option><option value="fr">French</option><option value="gl">Galician</option><option value="ka">Georgian</option><option value="de">German</option><option value="el">Greek</option><option value="ht">Haitian Creole</option><option value="iw">Hebrew</option><option value="hi">Hindi</option><option value="hu">Hungarian</option><option value="is">Icelandic</option><option value="id">Indonesian</option><option value="ga">Irish</option><option value="it">Italian</option><option value="ja">Japanese</option><option value="ko">Korean</option><option value="la">Latin</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="mk">Macedonian</option><option value="ms">Malay</option><option value="mt">Maltese</option><option value="no">Norwegian</option><option value="fa">Persian</option><option value="pl">Polish</option><option value="pt">Portuguese</option><option value="ro">Romanian</option><option value="ru">Russian</option><option value="sr">Serbian</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option value="es">Spanish</option><option value="sw">Swahili</option><option value="sv">Swedish</option><option value="th">Thai</option><option value="tr">Turkish</option><option value="uk">Ukrainian</option><option value="ur">Urdu</option><option value="vi">Vietnamese</option><option value="cy">Welsh</option><option value="yi">Yiddish</option></select><div style="text-align: left; background-color: rgb(235, 239, 249);">Detect language » Afrikaans</div><div style="width: 444px; max-width: 444px; padding: 2px; min-height: 80px; border-width: 1px; border-style: solid; border-color: grey; background-color: rgb(255, 255, 255); text-align: justify;"></div></div></body></html>